{"ts":1379078531307,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1379083649403,"patch":[[{"diffs":[[1," public function addSheet(PHPExcel_Worksheet $pSheet, $iSheetIndex = NULL)\n    {\n        if ($this->sheetNameExists($pSheet->getTitle())) {\n            throw new PHPExcel_Exception(\n            \t\"Workbook already contains a worksheet named '{$pSheet->getTitle()}'. Rename this worksheet first.\"\n            );\n        }\n\n        if($iSheetIndex === NULL) {\n            if ($this->_activeSheetIndex < 0) {\n                $this->_activeSheetIndex = 0;\n            }\n            $this->_workSheetCollection[] = $pSheet;\n        } else {\n            // Insert the sheet at the requested index\n            array_splice(\n                $this->_workSheetCollection,\n                $iSheetIndex,\n                0,\n                array($pSheet)\n                );\n\n            // Adjust active sheet index if necessary\n            if ($this->_activeSheetIndex >= $iSheetIndex) {\n                ++$this->_activeSheetIndex;\n            }\n        }\n        return $pSheet;\n    }\n\n    /**\n     * Remove sheet by index\n     *\n     * @param  int $pIndex Active sheet index\n     * @throws PHPExcel_Exception\n     */\n    public function removeSheetByIndex($pIndex = 0)\n    {\n\n        $numSheets = count($this->_workSheetCollection);\n\n        if ($pIndex > $numSheets - 1) {\n            throw new PHPExcel_Exception(\n            \t\"You tried to remove a sheet by the out of bounds index: {$pIndex}. The actual number of sheets is {$numSheets}.\"\n            );\n        } else {\n            array_splice($this->_workSheetCollection, $pIndex, 1);\n        }\n        // Adjust active sheet index if necessary\n        if (($this->_activeSheetIndex >= $pIndex) &&\n            ($pIndex > count($this->_workSheetCollection) - 1)) {\n            --$this->_activeSheetIndex;\n        }\n\n    }\n\n    /**\n     * Get sheet by index\n     *\n     * @param  int $pIndex Sheet index\n     * @return PHPExcel_Worksheet\n     * @throws PHPExcel_Exception\n     */\n    public function getSheet($pIndex = 0)\n    {\n\n        $numSheets = count($this->_workSheetCollection);\n\n        if ($pIndex > $numSheets - 1) {\n            throw new PHPExcel_Exception(\n            \t\"Your requested sheet index: {$pIndex} is out of bounds. The actual number of sheets is {$numSheets}.\"\n           \t);\n        } else {\n            return $this->_workSheetCollection[$pIndex];\n        }\n    }\n\n    /**\n     * Get all sheets\n     *\n     * @return PHPExcel_Worksheet[]\n     */\n    public function getAllSheets()\n    {\n        return $this->_workSheetCollection;\n    }\n\n    /**\n     * Get sheet by name\n     *\n     * @param  string $pName Sheet name\n     * @return PHPExcel_Worksheet\n     */\n    public function getSheetByName($pName = '')\n    {\n        $worksheetCount = count($this->_workSheetCollection);\n        for ($i = 0; $i < $worksheetCount; ++$i) {\n            if ($this->_workSheetCollection[$i]->getTitle() === $pName) {\n                return $this->_workSheetCollection[$i];\n            }\n        }\n"]],"start1":0,"start2":0,"length1":0,"length2":2951}]],"length":2951,"saved":false}
